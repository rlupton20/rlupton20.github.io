<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Lightweight screenshots in Xmonad &middot; Pure Hack</title><meta name=description content><meta name=generator content="Hugo 0.59.0"><meta name=twitter:card content="summary"><meta name=twitter:title content="Lightweight screenshots in Xmonad &middot; Pure Hack"><meta name=twitter:description content><meta property="og:type" content="article"><meta property="og:title" content="Lightweight screenshots in Xmonad &middot; Pure Hack"><meta property="og:description" content><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700" rel=stylesheet type=text/css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css><link rel=stylesheet href=https://rlupton20.github.io/css/all.min.css><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css rel=stylesheet><link rel=alternate type=application/rss+xml title="Pure Hack" href=https://rlupton20.github.io/index.xml></head><body><div id=layout class=pure-g><div class="sidebar pure-u-1 pure-u-md-1-4"><div class=header><hgroup><h1 class=brand-title><a href=https://rlupton20.github.io/>Pure Hack</a></h1><h2 class=brand-tagline></h2></hgroup><nav class=nav><ul class=nav-list><li class=nav-item><a class=pure-button href=https://github.com/rlupton20><i class="fa fa-github-alt"></i>Github</a></li><li class=nav-item><a class=pure-button href=https://rlupton20.github.io/index.xml><i class="fa fa-rss"></i>rss</a></li></ul></nav></div></div><div class="content pure-u-1 pure-u-md-3-4"><div><div class=posts><h1 class=content-subhead>11 Sep 2017, 16:00</h1><section class=post><header class=post-header><a href=https://rlupton20.github.io/posts/2017-09-11-lightweight-screenshots-in-xmonad/ class=post-title>Lightweight screenshots in Xmonad</a><p class=post-meta></p></header><div class=post-share><div class=post-share-links><h4>Share</h4></div></div><div class=post-description><h2 id=introduction>Introduction</h2><p>Xmonad does not come with any kind of screenshot tool (or anything at all much, which in my view is a good thing - what it does do it does well). I didn&rsquo;t want a heavyweight system (something taken from GNOME or XFCE), but wanted some flexibility still. I made a little script which straps together <code>rofi</code>, <code>slop</code>, <code>maim</code> and <code>xclip</code> to provide a lightweight and flexible screenshotting tool. I&rsquo;m posting it here for anyone who is looking for something similar. Add a keybinding in <code>xmonad</code> and off you go! Of course, this will work perfectly well with other window managers too.</p><p>I wanted to be able to do a combination of the following things
1. Capture the whole screen
2. Capture just a section of the screen
3. Possibly capture to clipboard
4. Possibly capture to file
selectable quickly and easily from some kind of popup menu.</p><p>I decided to bind this script to <code>Mod-PrintScr</code>, with <code>PrintScr</code> bound to <code>maim -s -c 1,0,0,0.6 --format png /dev/stdout | tee ~/.screenshots/$(date +%F-%T).png | xclip -selection clipboard -t image/png -i</code> (capture selection to file and clipboard), a default of sorts.</p><h2 id=the-script-explained>The script explained</h2><p>The script is presented below. It is also available <a href=https://github.com/rlupton20/dotfiles/blob/master/scripts/super-screenshot.sh>here</a>. I imagine most people would want to modify it/rewrite it/use it as a basis for their own systems. Chances are, if you like using a tiler, you long lost interest in keeping to &ldquo;sensible defaults&rdquo;. Tweak away!</p><p><code>maim</code> is the main tool here for making screenshots. It can use <code>slop</code> in the background to do selections. <code>xclip</code> provides a way to get captures onto the clipboard. I wanted several options to be selectable when making a screenshot, so I encoded these options in a slightly horrible way into the script (see <code>OPTIONS</code>). The script breaks these down into actual option names that can be fed to <code>rofi</code> (a <code>dmenu</code> like tool - you could use <code>dmenu</code>) using fairly standard *nix sorcery, then uses the selection to extract the parameters from <code>OPTIONS</code> before making the screenshot.</p><p>We use <code>/dev/null</code> as a file when we don&rsquo;t want to actually save to file, and when we do, we create a new file in <code>SCREENSHOT_DIR</code> (with a datestamp) to store the capture in. When we don&rsquo;t want to save to clipboard, we pipe the capture into <code>xclip -h</code>, the help command for <code>xclip</code>. Massive hack, but it works.</p><h2 id=source>Source</h2><pre><code class=language-bash>#!/usr/bin/env bash

# DEPENDENCIES
# rofi, maim, slop, xclip

SCREENSHOT_DIR=~/.screenshots

# Options are separated by ;, with each field separated by :
# FIELD 0: name
# FIELD 1: maim switches
# FIELD 2: save to file
# FIELD 3: put on clipboard
OPTIONS='select:&quot;-c 1,0,0,0.6 -s&quot;:y:y;window:&quot;-c 1,0,0,0.6 -st 9999999&quot;:y:y;screen:&quot;&quot;:y:y;clip:&quot;-c 1,0,0,0.6 -s&quot;:n:y'

function get_maim_switches {
    echo $(echo $OPTIONS | tr ';' '\n' | grep ^${1} | awk -F ':' '{print $2}' | xargs echo)
}

function get_save {
    echo $(echo $OPTIONS | tr ';' '\n' | grep ^${1} | awk -F ':' '{print $3}' | xargs echo)
}

function get_clip {
    echo $(echo $OPTIONS | tr ';' '\n' | grep ^${1} | awk -F ':' '{print $4}' | xargs echo)
}


# Get user choice
CHOICE=$(echo $OPTIONS | tr ';' '\n' | awk -F ':' '{print $1}' | rofi -dmenu)

# Extract maim switches
MAIM_SWITCHES=$(get_maim_switches $CHOICE)

# Determine where to save the screenshot (possibly /dev/null)
TO_SAVE=$(get_save $CHOICE)
if [[ $TO_SAVE == y ]]
then
    SAVE_FILE=${SCREENSHOT_DIR}/$(date +%F-%T).png;
else
    SAVE_FILE=/dev/null
fi

# Determine whether to add to clipboard
TO_CLIP=$(get_clip $CHOICE)
if [[ $TO_CLIP == y ]]
then
    CLIP=&quot;-selection clipboard -t image/png -i&quot;
else
    CLIP=&quot;-h&quot; # Hack hack hack (pipe into help)
fi

# Do the screenshot
maim $MAIM_SWITCHES --format png /dev/stdout | tee $SAVE_FILE | xclip $CLIP
</code></pre></div></section></div><div class=footer><div class="pure-menu pure-menu-horizontal pure-menu-open"><ul><li>Powered by <a class=hugo href=https://gohugo.io/ target=_blank>hugo</a></li></ul></div></div><script src=https://rlupton20.github.io/js/all.min.js></script></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','','auto');ga('send','pageview');</script></body></html>